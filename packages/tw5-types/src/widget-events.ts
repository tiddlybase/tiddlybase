export const MESSAGE_TYPES = [ // like urlembed props
 /*
 // https://tiddlywiki.com/static/WidgetMessage%253A%2520tm-add-field.html
 addField: 'tm-add-field',

 // https://tiddlywiki.com/static/WidgetMessage%253A%2520tm-add-tag.html
 addTag: 'tm-add-tag',

 // https://tiddlywiki.com/static/WidgetMessage%253A%2520tm-auto-save-wiki.html
 autoSaveWiki: 'tm-auto-save-wiki',

 // https://tiddlywiki.com/static/WidgetMessage%253A%2520tm-browser-refresh.html
 browserRefresh: 'tm-browser-refresh',

 // TODO
 clearBrowserStorage: 'tm-clear-browser-storage',

 // https://tiddlywiki.com/static/WidgetMessage%253A%2520tm-cancel-tiddler.html
 cancelTiddler: 'tm-cancel-tiddler',

 // https://tiddlywiki.com/static/WidgetMessage%253A%2520tm-clear-password.html
 clearPassword: 'tm-clear-password',
 */

 // https://tiddlywiki.com/static/WidgetMessage%253A%2520tm-close-all-tiddlers.html
 'tm-close-all-tiddlers',

 // https://tiddlywiki.com/static/WidgetMessage%253A%2520tm-close-all-windows.html
 'tm-close-all-windows',

 // https://tiddlywiki.com/static/WidgetMessage%253A%2520tm-close-other-tiddlers.html
 'tm-close-other-tiddlers',

 // https://tiddlywiki.com/static/WidgetMessage%253A%2520tm-close-tiddler.html
 'tm-close-tiddler',

 /*
 // https://tiddlywiki.com/static/WidgetMessage%253A%2520tm-close-window.html
 closeWindow: 'tm-close-window',

 // TODO
 consentAccept: 'tm-consent-accept',
 consentClear: 'tm-consent-clear',
 consentDecline: 'tm-consent-decline',

 // TODO
 copySyncerLogsToClipboard: 'tm-copy-syncer-logs-to-clipboard',

 // https://tiddlywiki.com/static/WidgetMessage%253A%2520tm-copy-to-clipboard.html
 copyToClipboard: 'tm-copy-to-clipboard',

 // https://tiddlywiki.com/static/WidgetMessage%253A%2520tm-delete-tiddler.html
 deleteTiddler: 'tm-delete-tiddler',

 // https://tiddlywiki.com/static/WidgetMessage%253A%2520tm-download-file.html
 downloadFile: 'tm-download-file',

 // https://tiddlywiki.com/static/WidgetMessage%253A%2520tm-edit-bitmap-operation.html
 editBitmapOperation: 'tm-edit-bitmap-operation',

 // https://tiddlywiki.com/static/WidgetMessage%253A%2520tm-edit-text-operation.html
 editTextOperation: 'tm-edit-text-operation',

 // https://tiddlywiki.com/static/WidgetMessage%253A%2520tm-edit-tiddler.html
 editTiddler: 'tm-edit-tiddler',

 // https://tiddlywiki.com/static/WidgetMessage%253A%2520tm-focus-selector.html
 focusSelector: 'tm-focus-selector',

 // https://tiddlywiki.com/static/WidgetMessage%253A%2520tm-fold-all-tiddlers.html
 foldAllTiddlers: 'tm-fold-all-tiddlers',

 // https://tiddlywiki.com/static/WidgetMessage%253A%2520tm-fold-other-tiddlers.html
 foldOtherTiddlers: 'tm-fold-other-tiddlers',

 // https://tiddlywiki.com/static/WidgetMessage%253A%2520tm-fold-tiddler.html
 foldTiddler: 'tm-fold-tiddler',

 // https://tiddlywiki.com/static/WidgetMessage%253A%2520tm-full-screen.html
 fullScreen: 'tm-full-screen',

 // https://tiddlywiki.com/static/WidgetMessage%253A%2520tm-home.html
 Home: 'tm-home',

 // https://tiddlywiki.com/static/WidgetMessage%253A%2520tm-import-tiddlers.html
 importTiddlers: 'tm-import-tiddlers',

 // https://tiddlywiki.com/static/WidgetMessage%253A%2520tm-load-plugin-from-library.html
 loadPluginFromLibrary: 'tm-load-plugin-from-library',

 // https://tiddlywiki.com/static/WidgetMessage%253A%2520tm-load-plugin-library.html
 loadPluginLibrary: 'tm-load-plugin-library',

 // https://tiddlywiki.com/static/WidgetMessage%253A%2520tm-login.html
 login: 'tm-login',

 // https://tiddlywiki.com/static/WidgetMessage%253A%2520tm-logout.html
 logout: 'tm-logout',

 // https://tiddlywiki.com/static/WidgetMessage%253A%2520tm-modal.html
 modal: 'tm-modal',
 */
 // TODO
 'tm-navigate',
 /*
 // https://tiddlywiki.com/static/WidgetMessage%253A%2520tm-notify.html
 notify: 'tm-notify',

 // https://tiddlywiki.com/static/WidgetMessage%253A%2520tm-open-external-window.html
 openExternalWindow: 'tm-open-external-window',

 // https://tiddlywiki.com/static/WidgetMessage%253A%2520tm-open-window.html
 openWindow: 'tm-open-window',

 // https://tiddlywiki.com/static/WidgetMessage%253A%2520tm-perform-import.html
 performImport: 'tm-perform-import',

 // https://tiddlywiki.com/static/WidgetMessage%253A%2520tm-permalink.html
 permalink: 'tm-permalink',

 // https://tiddlywiki.com/static/WidgetMessage%253A%2520tm-permaview.html
 permaview: 'tm-permaview',

 // https://tiddlywiki.com/static/WidgetMessage%253A%2520tm-print.html
 print: 'tm-print',

 // https://tiddlywiki.com/static/WidgetMessage%253A%2520tm-relink-tiddler.html
 relinkTiddler: 'tm-relink-tiddler',

 // https://tiddlywiki.com/static/WidgetMessage%253A%2520tm-remove-field.html
 removeField: 'tm-remove-field',

 // https://tiddlywiki.com/static/WidgetMessage%253A%2520tm-remove-tag.html
 removeTag: 'tm-remove-tag',

 // https://tiddlywiki.com/static/WidgetMessage%253A%2520tm-rename-tiddler.html
 renameTiddler: 'tm-rename-tiddler',

 // https://tiddlywiki.com/static/WidgetMessage%253A%2520tm-save-tiddler.html
 saveTiddler: 'tm-save-tiddler',

 // https://tiddlywiki.com/static/WidgetMessage%253A%2520tm-save-wiki.html
 saveWiki: 'tm-save-wiki',

 // https://tiddlywiki.com/static/WidgetMessage%253A%2520tm-scroll.html
 scroll: 'tm-scroll',

 // https://tiddlywiki.com/static/WidgetMessage%253A%2520tm-server-refresh.html
 serverRefresh: 'tm-server-refresh',

 // https://tiddlywiki.com/static/WidgetMessage%253A%2520tm-set-password.html
 setPassword: 'tm-set-password',

 // TODO
 showSwitcher: 'tm-show-switcher',

 // TODO
 sliceTiddler: 'tm-slice-tiddler',

 // https://github.com/Jermolene/TiddlyWiki5/blob/775c7f00746a5c4d83babdec81e59f4aea3c2e04/plugins/tiddlywiki/jszip/docs.tid
 zipAddTextFile: 'tm-zip-add-text-file',
 zipCreate: 'tm-zip-create',
 zipDownload: 'tm-zip-download',
 zipRenderFile: 'tm-zip-render-file',

 // https://tiddlywiki.com/static/WidgetMessage%253A%2520tm-unfold-all-tiddlers.html
 unfoldAllTiddlers: 'tm-unfold-all-tiddlers',

 // https://tiddlywiki.com/static/WidgetMessage%253A%2520tm-unload-plugin-library.html
 unloadPluginLibrary: 'tm-unload-plugin-library'
 */
 ] as const;

export type MessageType = typeof MESSAGE_TYPES[number];

export interface TW5EventBase {
  type: MessageType;
  // keyboard modifiers set when event fired
  metaKey?: boolean,
  ctrlKey?: boolean,
  altKey?: boolean,
  shiftKey?: boolean,
  // DOM event triggering Widget event (if any)
  event?: Event,
}

export interface NavigateEvent extends TW5EventBase {
  type: 'tm-navigate';
  navigateTo: string;
  navigateFromTitle?: string;
  navigateFromNode?: Node,
  navigateSuppressNavigation?: boolean
  navigateFromClientRect?: {
          top: number,
          left: number,
          width: number,
          right: number,
          bottom: number,
          height: number,
  },
  navigateFromClientTop?: number,
  navigateFromClientLeft?: number,
  navigateFromClientWidth?: number,
  navigateFromClientRight?: number,
  navigateFromClientBottom?: number,
  navigateFromClientHeight?: number,
}

export interface CloseTiddlerEvent extends TW5EventBase {
  type: 'tm-close-tiddler';
  tiddlerTitle: string;
}

export interface CloseAllTiddlersEvent extends TW5EventBase {
  type: 'tm-close-all-tiddlers';
}

export interface CloseOtherTiddlersEvent extends TW5EventBase {
  type: 'tm-close-other-tiddlers';
  tiddlerTitle: string;
}

export type WidgetEvent =
  | NavigateEvent
  | CloseTiddlerEvent
  | CloseAllTiddlersEvent
  | CloseOtherTiddlersEvent

export type WidgetEventHandler<T extends WidgetEvent> = (event:T)=>boolean|undefined

export interface WidgetEventAPI {
  addEventListener<T extends WidgetEvent>(type: T["type"], handler:WidgetEventHandler<T>): void;
  // TODO: don't know how to type this properly
  // Can likely be solved using: https://instil.co/blog/crazy-powerful-typescript-tuple-types/
  // addEventListeners<T extends [...any[]]>(listeners: ConvertEventListeners<T>): void;
  dispatchEvent(event: WidgetEvent): void;
}
